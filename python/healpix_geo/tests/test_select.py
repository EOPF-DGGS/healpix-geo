import numpy as np

import healpix_geo


def test_cells_in_polygon():
    cell_ids = np.array(
        [
            1344,
            1345,
            1347,
            1348,
            1349,
            1350,
            1666,
            1672,
            1673,
            1674,
            2365,
            2366,
            2367,
            2402,
            2403,
            2404,
            2405,
            2406,
            2407,
            2408,
            2409,
            2410,
            2411,
            2412,
            2413,
            2414,
            2415,
            2418,
            2424,
            2425,
            2426,
            2427,
            2430,
            2447,
            2449,
            2451,
            2452,
            2453,
            2454,
            2455,
            2456,
            2457,
            2458,
            2459,
            2460,
            2461,
            2462,
            2463,
            2480,
            2481,
            2483,
            2484,
            2485,
            2486,
            2487,
            2492,
            2493,
            2495,
            2496,
            2497,
            2498,
            2499,
            2500,
            2501,
            2502,
            2503,
            2504,
            2505,
            2506,
            2507,
            2508,
            2509,
            2510,
            2511,
            2512,
            2513,
            2514,
            2515,
            2516,
            2517,
            2518,
            2519,
            2520,
            2521,
            2522,
            2523,
            2524,
            2525,
            2526,
            2527,
            2528,
            2529,
            2530,
            2531,
            2532,
            2533,
            2534,
            2535,
            2536,
            2537,
            2538,
            2539,
            2540,
            2541,
            2542,
            2543,
            2544,
            2545,
            2546,
            2547,
            2548,
            2549,
            2550,
            2552,
            2553,
            2554,
        ],
        dtype="uint64",
    )  # fmt:off

    polygon = np.array(
        [
            (-43.6345972634, 80.338953078),  # lat lon
            (-43.6345972634, 123.569469029),
            (-10.6681857235, 123.569469030),
            (-10.6681857235, 80.338953079),
        ],
        dtype="float64",
    )

    selected_cells = healpix_geo.select.cells_in_polygon(cell_ids, 4, polygon)
    # np.testing.assert_equal(cell_ids, selected_cells)

    # 80.338953078, -43.6345972634
    # 123.569469029, -43.6345972634
    # 123.569469030, -10.6681857235
    # 80.338953079, -10.6681857235
